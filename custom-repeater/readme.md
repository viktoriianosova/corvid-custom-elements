Corvid Custom Repeater
====

The Corvid custom repeater is a Corvid Custom Element (Web Component) built to deliver higher flexibility
for displaying repeated elements. The Corvid Custom Repeater implements full SEO and navigation support, including
on-click support.


[See Corvid Custom Repeater in action](https://yoav68.wixsite.com/custom-elem-repeater)

This is an advanced level example, requiring understanding of HTML and CSS.

## installation

1. Copy all the files under the public folder to the Public folder in corvid.
1. Add a Custom Element on a Corvid Page
  1. Open the Add menu
  1. Embed sub menu
  1. From Embeds, select Custom Element
1. Setup the Custom Element to use the repeater Corvid file
  1. Click Choose Source for the custom element (or setup, if the custom element was previously setup)
  1. Select 'Corvid File', for 'add your script file with'
  1. Select the file 'repeater.js' from the list
  1. enter `elem-repeater` as the tag name
1. In your page code, initialize the custom repeater element

for example - using data from Wix Data
```javascript
import {RepeaterAPI} from 'public/repeater-api';
import {renderRepeater, renderSlide, css} from 'public/design1';
import wixData from 'wix-data';

$w.onReady(async function () {
	let repeater = new RepeaterAPI($w('#CustomElement1'), renderRepeater, renderSlide);
	repeater.css = css;

	let res = await wixData.query('vacations')
		.limit(500)
		.ascending('dates')
		.find();
	repeater.data = res.items;
});
```

## The Repeater API

The `Public/repeater-api` module provides an API for the custom element, as well as support for navigation,
on-click and SEO.

### Constructor

``` javascript
new RepeaterAPI(elem: Element, repeaterTemplate: RenderRepeater, itemTemplate: RenderSlide);
function RenderRepeater(itemsHtml: Array<String>): String;
function RenderSlide(item: Object): String;
```

The Repeater API accepts the repeater custom element and two functions.

itemTemplate renders the HTML for a single item in the repeater. It is called for each item in the data array.

repeaterTemplate is a function that renders the repeater full HTML, that is used both for SEO and displaying the repeater itself.
The function accepts as a parameter an array of HTML fragments generated by calling the itemTemplate on each of the items in the data
property.


### Property css: String
A CSS string that is set as the style tag for the custom element.

### Property data: Array<Object>
A property for the data to display in the repeater. The Data is assumed to be an array of objects, for each the repeater calls the
itemTemplate to generate the HTML for that item.

### support for navigation
To support navigation, the repeater API exposes the `link` function which renders a pair of `href` and `data-link`.

Example
Assume our item was read from the Wix Data database, and has a link to a dynamic page named (the link field) `link-vacations-1-title`.

```javascript
import {link} from './repeater-api';

let HTML = `<a ${link(item['link-vacations-1-title'])}>`;
```

This pattern generates both the right link with href for SEO and will support navigation in Corvid using the location.to function.

### support for images

Images url in Corvid are stored using internal format that looks like `wix:image://...`. To convert this format to an HTML friendly format,
the repeater API exposes a `wixImageToWeb` function. The function requires a Corvid image url, as well as target size for the image to
optimize the image loading

Example
```javascript
import {wixImageToWeb} from './repeater-api';

let HTML = `<img src="${wixImageToWeb(item.picture, 700, 516)}"></img>`
```

### support for on-click

Support for on click includes two parts - adding on-click markers in the HTML and listening to onClick events on the repeater api.

To add on-click markers, using the `onClick` function from repeater API when creating the item HTML.

```javascript
import {onClick} from './repeater-api';

let HTML = `<div ${onClick('marker1')}>`;
```

When a user clicks on the above DOM element, the repeater API onClick callback will be called with the specified marker

```javascript
let repeater = new RepeaterApi(...);

repeater.onClick(marker => {
   // do something with the on click
});
}
```










